# 密码学（cryptography）

[TOC]



## 绪论

+ 密码学的核心是安全通信。
  + 密钥建立
  + 共享密钥

+ 密码学更多应用
  + 数字签名
  + 匿名通信
  + 匿名数字现金
  + 私有外包计算（e.g.基于加密数据的Google搜索）
  + 零知识证明
+ 安全多方计算

+ anything the can done with trusted auth.can also be done without

## 密码学历史

> 密码学早在公元前400多年就已经产生，人类使用密码的历史几乎与使用文字的时间一样长，密码学的发展大致可以分为 3 个阶段: 1949 年之前的古典密码学阶段; 1949 年至 1975 年密码学成为科学的分支; 1976 年以后对称密钥密码算法得到进一步发展，产生了密码学的新方向—公钥密码学。1976 年，W.Diffie 和 M.Hellman 在发表的文章“密码学的新方向”中首次公开提出了公钥密码( Public-key Cryptography) 的概念。公钥密码的提出实现了加密密钥和解密密钥之间的独立，解决了对称密码体制中通信双方必须共享密钥的问题，在密码学界具有划时代的意义。

+ 古典密码：

  + 滚桶密码

  + 掩格密码

  > 16世纪米兰的物理学和数学家Cardano发明的掩格密码，可以事先设计好方格的开孔，将所要传递的信息和一些其他无关的符号组合成无效的信息，使截获者难以分析出有效信息。

  + 凯撒密码
  + 弗纳姆密码

  > 1918年Gilbert Vernam 为AT&T设计的一种一次一密乱码本密码（多表代换密码）。

  + 维吉尼亚密码
  + 换位（置换）密码

+ 近代密码学



## 密码分析

+ 常用攻击类型：选择明文攻击、已知明文攻击、选择密文攻击、唯密文攻击。（其中选择密文攻击最难破译）
+ 大多数古典密码都无法抵抗唯密文攻击（如单表代换和多表代换），主要使用频率分析法。
+ 多字母代换使用唯密文攻击比较困难，但是不能抵抗已知明文攻击（比如希尔密码）
+ Kasiski测试法
+ 重合指数法



## 密码理论

#### 同态加密理论

> **同态加密理论**在 1978 年首次推出，被认为是密码学领域的圣杯之一：直到目前为止仍像传奇一样遥不可及，但研究人员仍迫切找到一种行之有效的方法。最近的发展进程，包括计算机科学家 Craig Gentry 在2009年的博士论文，数字领域的第一个<u>完全同态加密</u>[^2]方案，以及第二代 HElib[^1]，FHEW 和 TFHE libraries 。Gentry 的工作为他赢得了2014年 MacArthur 基金会的“Genius Grant”奖，五年内的收入累计达到了 625,000 美元，在收集和分析更多数据的同时努力保护隐私方面，也有越来越多的密码学研究人员正朝着它的方向发展.

[^1]: HElib是IBM用C++写成的一个开源的同态加密库。
[^2]: 英文简称为FHE。若满足加法同态和乘法同态则为完全同态。



> 同态加密是基于数学难题的**计算复杂性理论**的密码学技术。对经过同态加密的数据进行处理得到一个输出，将这一输出进行解密，其结果与用同一方法处理未加密的原始数据得到的输出结果是一样的。



+ 应用：云计算、多方保密计算、匿名投票等。

![](C:\Users\lenovo\AppData\Roaming\Typora\typora-user-images\1568179917692.png)

+ 发展

  > (1)1978 年Rivest 等人于提出同态加密概念，推出了最早的公钥密码体系RSA，此方案满足乘法同态性。
  >
  > (2)2009年Gentry提出了第一个完全同态加密方案[1]，该方案是**基于理想格**构造的，困难性基于两个假设：格上的标准难题和稀疏子集和难题。
  >
  > (3)2009年Dijk、Gentry等人提出了整数上的完全同态加密方案[2]，困难性基于近似GCD难题。该方案主要贡献是将原来基于“理想格”的SWHE替换为一个非常简单的整数描述的SWHE。在概念上的进行了极大的化简，但依旧是使用Gentry的同态解密技术将SWHE其转化为FHE。故效率没有提高。
  >
  > (4)2011年Brakerski、Gentry、Vaikuntanathan提出的完全同态加密方案[3]，简称BGV方案，可以看做第二代FHE。**困难性基于LWE（纠错学习）**。利用密钥交换技术、模交换技术来降低密文维数和减弱噪音，使得效率大大提高。

  + 部分同态加密

    + RSA（乘法同态）
    + Paillier公钥加密算法（加法同态）

  + 第一代FHE（整数版本）

    近似完全同态加密算法在进行同态运算时会使噪音增长，噪音超过上界会使密文无法正常解密。

    + 思想：利用特殊代数结构——多项式环或整数环的理想
    + 特点：基于非标准困难假设
    + 代表性工作：Gentry09方案

  + 第二代FHE

    + 思想：分层的同态加密
    + 特点：标准的困难假设——LWE问题或ring LWE问题
    + 代表性工作：BV11方案、BGV12

  + 第三代FHE

    + 思想：使用近似特征向量的结构
    + 代表工作：GSW13



#### NTRU(Number Theory Research Unit)算法

> NTRU(Number Theory Research Unit)算法是1996年由美国布朗大学三位数学教授发明的公开秘密体制。NTRU一种比较新的公开密钥体制，由于NTRU产生的密钥方法比较容易，加密、解密的速度比RSA等著名算法快得多，NTRU成为当前公钥体制研究的一个热点。
>
> NTRU是一个带有专利保护的开源公开密钥加密系统，基于格的加密算法来加密数据。它包括两部分算法：NTRUEncrypt用来加密，NTRUSign用来进行数字签名。与其他流行的公钥加密系统不同，它可以防止被Shor算法[^1]破解，并显著提升了性能。

[^1]: 舒尔算法，即秀尔算法，以数学家彼得.秀尔命名，是一个在1994年发现的，针对整数分解这题目的量子算法。



> 这是一个基于多项式环的密码体制。**它的安全性依赖于格中最短向量问题（SVP）**。相对于离散对数或大数分解等公开秘密体制来说，它有许多优势。在安全性方面，NTRU算法<u>具有抵抗量子计算攻击的能力</u>，而RSA和ECC算法是无法抵抗量子计算的。当前，对于用什么公钥密码来替代正在大量使用的RSA和ECC，主要有以下互相竞争的技术解决方案：NTRU公钥密码体制、McEliece 公钥密码体制[^1]、MQ 公钥密码体制[^2]。

[^1]: McEliece 公钥密码体制的安全性基于纠错码问题，安全性强，但计算效率低。
[^2]: MQ 公钥密码体制，即多变元二次多项式公钥密码体制（Multivariate Quadratic Polynomials in Public KeyCryptosystem），基于有限域上的多变元二次多项式方程组的难解性，在安全性方面的缺点比较明显。



#### A5算法

> A5算法在1989年由法国人开发，用于GSM系统的序列密码算法。

A5/1算法使用3个线性反馈移位寄存器，简称为LFSR。三个寄存器分别为19、22、22、23位。这里主要使用三个共包含64位二进制的线性反馈移位寄存器，A5/1的密钥长度也是64位。





## 安全协议

![img](https://lisenh.myds.me:8/file/201906/29/231509078.png)

#### IPsec协议

> IPSec是网际层实现IP分组端到端安全传输的机制,是以RFC形式公布的一组安全协议集,是在IP包级为IP业务提供保护的安全协议.IPSec将几种安全技术结合形成一个比较完整的安全体系结构.注意IP sec是安全协议集。将几种安全技术结合形成一个比较完整的安全体系结构。



![image.png](https://lisenh.myds.me:8/file/201906/29/231519581.png)

+ 提供的安全服务：数据完整性、认证、保密性、应用透明的安全性

+ 工作模式：传输模式和隧道模式

+ IPsec重要协议：

  + 安全通信协议：
    + AH鉴别首部：认证+数据完整性检测
    + ESP封装安全载荷：认证+数据加密+数据完整性检测
  + 密钥管理协议（IKE)

  > IKE实际上是三个协议ISAKMP、OAKLEY和、SKEME的混合体。使用的协议都是IPsec组成中的协议
  >
  > ISAKMP提供了认证和密钥交换的框架
  > OAKLEY描述了密钥交换的模式
  > SKEME定义了密钥交换技术
  > IKE在作用就是在通信系统之间建立安全关联(SA),提供密钥确定、密钥管理的机制;IKE将密钥协商的结果保留在SA。





#### SSL协议

> （Secure Socket Layer，安全套接字层），位于可靠的面向连接的网络层协议和应用层协议之间的一种协议层。SSL通过互相认证、使用数字签名确保完整性、使用加密确保私密性，以实现客户端和服务器之间的安全通讯。该协议由两层组成：SSL记录协议和SSL握手协议。

​		**SSL协议提供的服务主要有：**

　　1）认证用户和服务器，确保数据发送到正确的客户机和服务器；

　　2）加密数据以防止数据中途被窃取；

　　3）维护数据的完整性，确保数据在传输过程中不被改变。





#### TSL协议

> (Transport Layer Security，传输层安全协议)，用于两个应用程序之间提供保密性和数据完整性。该协议由两层组成：TLS记录协议和TLS握手协议。
